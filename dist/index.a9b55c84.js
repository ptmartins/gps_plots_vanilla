!function(){let e={},t=null,a=[],n="all",o={center:[38.7223,-9.1393],zoom:7,maxZoom:16,minZoom:7},s={1:L.latLng(45,-7),2:L.latLng(35,-11)},l={dashboard:{title:"Dashboard",icon:"fa-solid fa-gauge-high",path:"/dashboard"},map:{title:"Map",icon:"fa-solid fa-location-dot",path:"/map"},observations:{title:"Observations",icon:"fa-solid fa-table-list",path:"/observations"}},d={totalObservations:0,species:{},totalSpecies:0,totalGroupSize:0,avgGroupSize:0},i=()=>{e.loadingSpinner=document.getElementById("loading"),e.navList=document.getElementById("navList"),e.appHeader=document.getElementById("appHeader"),e.appBody=document.getElementById("appBody"),e.appFooter=document.getElementById("appFooter")},p={appTitle:()=>{let e=document.createElement("H2");return e.className="app_title",e.textContent="GPS Plots",e},viewTitle:e=>{let t=document.createElement("H2");return t.className="view__title",t.textContent=e,t},welcome:e=>{let t=document.createElement("DIV");return t.className="app_welcome",t.textContent=`Welcome, ${e??"Pedro"}`,t},statsCard:(e,t,a,n)=>{let o=document.createElement("DIV"),s=document.createElement("H3"),l=document.createElement("SPAN"),d=document.createElement("SPAN"),i=document.createElement("I");if(o.className="stats__card",s.className="stats__card__title",l.className="stats__card__value",d.className="stats__card__variation",i.className="stats__card__icon",s.textContent=e,l.textContent=t,o.append(s,l),a&&!n&&(d.textContent=a,o.appendChild(d)),n&&!a){let e=n.split(" ");e.forEach(e=>{i.classList.add(e)}),o.appendChild(i)}return o},menuItem:(e,t,a)=>{let n=document.createElement("LI"),o=t.split(" ");return n.className="nav__item",o.forEach(e=>{n.classList.add(e)}),n.setAttribute("title",e),n.setAttribute("data-path",a),n},listItem:(e,t,a,n,o,s)=>{let l=document.createElement("DIV"),d=document.createElement("I"),i=document.createElement("TIME"),p=document.createElement("H3"),m=document.createElement("P"),c=document.createElement("DIV"),r=document.createElement("SPAN"),u=document.createElement("SPAN"),_=e.split(" ");return d.className="list__item__icon",_.forEach(e=>{d.classList.add(e)}),l.className="list__item",i.className="list__item__date",p.className="list__item__species",m.className="list__item__groupSize",c.className="list__item__coordinates",r.className="list__item__lat",u.className="list__item__long",i.textContent=t,p.textContent=a,m.textContent=n,r.textContent=o,u.textContent=s,c.append(r,u),l.append(d,i,p),n&&l.appendChild(m),o&&s&&l.appendChild(c),l},panel:(e,t)=>{let a=document.createElement("DIV"),n=document.createElement("H2"),o=document.createElement("DIV");return a.className="panel",n.className="panel__header",n.textContent=e,t&&a.classList.add(t),a.append(n,o),a},map:()=>{let e=document.createElement("DIV");return e.id="map",e.className="map",e},select:(e,a)=>{let o=document.createElement("SELECT"),s=document.createElement("OPTION");return s.value="all",s.textContent="All species",o.appendChild(s),a.forEach(e=>{let t=document.createElement("OPTION");t.value=e,t.textContent=e,o.appendChild(t)}),o.addEventListener("change",a=>{n=a.target.value,t&&t.remove(),u(e,n)}),o}},m=()=>{let t=p.appTitle(),a=p.welcome();e.appHeader.append(t,a)},c=()=>{e.appFooter.innerHTML=`
            <p>GPS Plots - \xa9 2022 </p>
            <p>Developed with â™¥ by <a href="https://ptmartins.gothub.io" target="_blank">Pedro Martins</a></p>
        `},r=(t,n)=>{v(),h(e.appBody,"app__body app__body--map");let o=p.viewTitle("Map"),s=p.select(t,a),l=p.map();o.appendChild(s),e.appBody.appendChild(o),e.appBody.appendChild(l),u(t,n)},u=(e,a)=>{setTimeout(()=>{(t=L.map("map").setView(o.center,o.zoom)).options.maxZoom=o.maxZoom,t.options.minZoom=o.minZoom,t.setMaxBounds([s[1],s[2]]),L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:16,attribution:"\xa9 OpenStreetMap"}).addTo(t),addPoints(e,t)},1e3)};addPoints=(e,t)=>{for(var a=0;a<e.length;a++)"all"===n?L.marker([e[a].latitude,e[a].longitude]).bindPopup(e[a].common_name).addTo(t):n==e[a].common_name&&L.marker([e[a].latitude,e[a].longitude]).bindPopup(e[a].common_name).addTo(t)};let _=t=>{h(e.appBody,"app__body app__body--observations"),v(),e.appBody.appendChild(p.viewTitle("Observations"));let a=document.createElement("DIV"),n=document.createElement("DIV"),o=document.createElement("DIV");a.className="table",n.className="table__header",o.className="table__body";for(let e=0;e<5;e++){let t=document.createElement("SPAN");switch(e){case 0:t.textContent="";break;case 1:t.textContent="Date";break;case 2:t.textContent="Species";break;case 3:t.textContent="Group Size";break;case 4:t.textContent="Coordinates"}n.appendChild(t)}t.forEach(e=>{let t=p.listItem("fa-solid fa-binoculars",e.date_time,e.common_name,e.group_size,e.latitude,e.longitude);o.appendChild(t)}),a.append(n,o),e.appBody.appendChild(a)},h=(e,t)=>{let a=t.split(" ");e.classList.remove(...e.classList),a.forEach(t=>{e.classList.add(t)})},b=t=>{h(e.appBody,"app__body app__body--dashboard"),v(),f(t),E(t),C(t)},E=t=>{let a=document.createElement("DIV"),n=document.createElement("CANVAS"),o=n.getContext("2d"),s=Object.keys(d.species),l=Object.values(d.species);a.className="panel panel--dashBoardChart",n.className="panel__canvas",n.id="dashBoardChart",a.appendChild(n),s.forEach((e,t)=>{let a=e.split(" ");a.forEach((t,n)=>{a.length>1&&0==n&&(a[n]=t.charAt(0).toUpperCase()+"."),e=a.join(" ")}),s[t]=e}),new Chart(o,{type:"bar",data:{labels:s,datasets:[{label:"Observations by species",data:l}]},options:{plugins:{legend:{position:"bottom"}},scales:{x:{grid:{display:!1}},y:{grid:{display:!1}}}}}),e.appBody.appendChild(a)},C=t=>{let a=p.panel("Last Observations","panel--lastObservations");for(let e=0;e<8;e++){let n=p.listItem("fa-solid fa-binoculars",t[e].date_time,t[e].common_name);a.appendChild(n)}e.appBody.appendChild(a)},v=()=>{e.appBody.innerHTML=""},g=t=>{for(let a in e.menuItems=[],t){let n=p.menuItem(t[a].title,t[a].icon,t[a].path);e.navList.appendChild(n),e.menuItems.push(n)}},f=e=>{for(let t in e.forEach(e=>{d.totalObservations+=1,d.species[e.scientific_name]?d.species[e.scientific_name]+=1:d.species[e.scientific_name]=1,d.totalGroupSize+=e.group_size,d.avgGroupSize=Math.round(d.totalGroupSize/d.totalObservations)}),d.species)d.totalSpecies+=1;renderStats()};renderStats=()=>{let t=p.statsCard("Total Species",d.totalSpecies,void 0,"fa-solid fa-hashtag"),a=p.statsCard("Total Observations",d.totalObservations,void 0,"fa-solid fa-binoculars"),n=p.statsCard("Average Group Size",d.avgGroupSize,void 0,"fa-solid fa-binoculars"),o=document.createElement("DIV");o.className="stats__wrapper",o.append(t,a,n),e.appBody.appendChild(o)};let y=()=>{e.loadingSpinner.style.display="none"},N=async()=>{let e=await fetch("/data/data.json");await e.json().then(e=>{setTimeout(()=>{x(e),y(),I(e),f(e),b(e),S(e)},1e3)})},I=e=>{e.forEach(e=>{let t=e.common_name;a.includes(t)||a.push(t)})},x=e=>{let t={year:"numeric",month:"short",day:"numeric"},a=navigator.language;e.forEach(e=>{e.date_time=new Date(e.date_time).toLocaleString(a,t)}),e.sort((e,t)=>new Date(t.date_time)-new Date(e.date_time))},S=t=>{e.menuItems.forEach(e=>{e.addEventListener("click",()=>{let a=e.getAttribute("data-path");"/map"===a?r(t,n):"/observations"===a?_(t):"/dashboard"===a&&b(t)})})},B=()=>{m(),c(),g(l)};window.addEventListener("DOMContentLoaded",()=>{i(),B(),N()})}();
//# sourceMappingURL=index.a9b55c84.js.map
